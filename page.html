<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8"/>
<title>A Test Page</title>
<link rel="stylesheet" href="style.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="settings.js"></script>
<script src="io.js"></script>
<script src="util.js"></script>
<script src="world.js"></script>
<script src="parser.js"></script>
<script src="data.js"></script>

<script>
var savedCommands = ['help'];
var savedCommandsPos = 0;

$( document ).ready(function() {
  $('#textbox').keydown(function(event){
    var keycode = (event.keyCode ? event.keyCode : event.which);
    if(keycode == '13'){
      var s = $('#textbox').val();
      if (CMD_ECHO) { msg(s); }
      savedCommands.push(s);
      savedCommandsPos = savedCommands.length;
      parser.parse(s);
      $('#textbox').val('');
    }
    if(keycode == '37'){
      // left arrow
      if (event.shiftKey) {
        if (CMD_ECHO) { msg("west"); }
        parser.parse("west");
        $('#textbox').val('');
      }
    }
    if(keycode == '38'){
      // up arrow
      if (event.shiftKey) {
        if (CMD_ECHO) { msg("north"); }
        parser.parse("north");
        $('#textbox').val('');
      }
      else {
        savedCommandsPos -= 1;
        if (savedCommandsPos < 0) { savedCommandsPos = 0; }
        $('#textbox').val(savedCommands[savedCommandsPos]);
      }
    }
    if(keycode == '39'){
      // right arrow
      if (event.shiftKey) {
        if (CMD_ECHO) { msg("east"); }
        parser.parse("east");
        $('#textbox').val('');
      }
    }
    if(keycode == '40'){
      // down arrow
      if (event.shiftKey) {
        if (CMD_ECHO) { msg("south"); }
        parser.parse("south");
        $('#textbox').val('');
      }
      else {
        savedCommandsPos += 1;
        if (savedCommandsPos >= savedCommands.length) { savedCommandsPos = savedCommands.length - 1; }
        $('#textbox').val(savedCommands[savedCommandsPos]);
      }
    }
    if(keycode == '27'){
      // ESC
      $('#textbox').val('');
    }
  });    
  init();
  setup();
  setRoom(player.loc);
});
</script>


</head>



<body>


<div id="main">
<div id="output">
</div>
<div id="input">
  >
  <input type="text" name="textbox" id="textbox" />
</div>
</div>


<script>
document.writeln('<div id="panes" class="sidenav' + PANES + '">');

writeExit = function(n) {
  document.writeln('<td class="compassbutton">');
  document.writeln('<span class="compassbutton" id="exit' + exits[n].name + '" onclick="clickExit(\'' + exits[n].name + '\')">' + exits[n].abbrev + '</span>');
  document.writeln('</td>');
};

if (COMPASS) {
  document.writeln('<table>');
  for (var i = 0; i < 3; i++) {
    document.writeln('<tr>');
    writeExit(0 + 5 * i);
    writeExit(1 + 5 * i);
    writeExit(2 + 5 * i);
    document.writeln('<td></td>');
    writeExit(3 + 5 * i);
    writeExit(4 + 5 * i);
    document.writeln('</tr>');
  }
  document.writeln('</table>');
}

for (var i = 0; i < inventories.length; i++) {
  document.writeln('<hr/>');
  document.writeln('<h6>' + inventories[i].name + ':</h6>');
  document.writeln('<div id="' + inventories[i].alt + '">');
  document.writeln('</div>');
}

document.writeln('</div>');
</script>

</body>
</html> 